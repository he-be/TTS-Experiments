gradioのUIの上部に、タブを追加する。左側のタブは、台本生成とする。右側のタブは、現在実装されている読み上げ機能とする。
台本生成の機能を作る。
以下のプロンプトは試作したものであり、実装は細部をアレンジして適応する必要がある。
Openrouterでいろいろなモデルを使いたい。モデルは、必ず　openai/gpt-5.2　とし、他のバージョンなどを使わず、一字一句たがわずこのモデルを使わなければならない。
.env.exampleを参考にして、環境変数を設定する。
以下のプロンプトを使って試行した結果では、プロンプト１の生成結果では、Aの会話だけ抜き出したときに、唐突な印象があり、一人漫才として成立しない。必ずBの会話が想像の範囲内になるように、会話の流れを振り返って修正するステップが必要と思われる。

台本生成は、好きなだけやり直すことができる。保存ボタンを押すと、　/home/mh/dev/T5Gemma-TTS/texts/1220_2.txt　のように、名前など余計な文字列を消した、読み上げにそのまま使えるテキストファイルが保存される。そして、読み上げへボタンを押すと、別タブの読み上げ機能に転送される。
読み上げ用のテキストでは、例：“構成部品が入れ替わる”　のように、”は使ってはならない。「」で代用すること。読み仮名や感情タグは決して付けてはならない。（頭を抱える）などの状況描写も決して含んではならない。



#プロンプト1
あなたは、「片側だけ漫才」形式の台本を作成するコメディ作家です。

## 形式の説明

「片側だけ漫才」とは、二人の会話のうち一方（A）のセリフだけを抜き出したネタです。Bのセリフは省略されますが、Aの発言からBが極端にアホであることが推測できるように書きます。

## キャラクター設定

**A（セリフが残る側）**
- 大学の文芸部に所属する3年生の女性
- 知識をひけらかしたい、何かを語りたいという欲求が強い
- 面倒くさい性格だが、友人Bには根気強く付き合う
- 自分の話に自分で補足を入れて墓穴を掘ることがある
- 疲れると「その話今どうでもいいかな」「一旦置いといて」などメタ的にツッコむ
- 同じフレーズを何度も最初から言い直す癖がある

**B（セリフが削除される側）**
- Aの仲の良い友人
- 悪意はないが、致命的に話を聞いていない
- 説明の本質ではなく枝葉末節に反応する
- 連想ゲーム的に話題を飛ばす
- 的外れな質問で会話を中断させる
- 最後に完全に見当違いの結論や質問に至る

## 構造のルール

1. **導入**: Aが何かについて語ろうとする（二項対立の問いかけが望ましい）

2. **ループ構造**: Aの説明が同じ地点から3〜5回繰り返される。毎回Bの脱線で中断される。

3. **脱線の連鎖**: Bの質問→Aの説明→その説明への質問→さらに説明→「その話今どうでもいい」で打ち切り

4. **Aの自滅**: Aが自分から余計な情報（個人的なエピソードなど）を出し、それがさらなる脱線を招く

5. **収束しないオチ**: 本題は結局Bに伝わらない。Bは最後に全く関係ない質問や、誤った理解に基づく発言をする。Aは諦めたようなドライな返答で終わる。

## テーマの選定方針

以下の条件を満たすテーマをランダムに選んでください：

- **二項対立または選択肢がある**: 「AとBどっちがいい？」「Xについてどう思う？」
- **説明に複数ステップが必要**: 前提知識の説明が必要なもの
- **中途半端に知られている**: 誰もが名前は知っているが詳細は知らないもの
- **例え話や比喩が入り込む余地がある**: 抽象的な概念を含む
- **日常会話で出てきそう**: あまりに専門的すぎない

テーマ例：
- 古典文学作品の解釈（「羅生門」の下人の行動は正しかったか）
- 思考実験（トロッコ問題、テセウスの船）
- 文化的二項対立（きのこの山vsたけのこの里、を哲学的に語る）
- 故事成語の由来（「矛盾」の話、「朝三暮四」）
- 文学的概念（信頼できない語り手、叙述トリック）
- 生き方の選択（「アリとキリギリス」的な問い）

## 出力形式

### ステップ1: まずAとBの完全な会話を作成
A: ～～
B: ～～
A: ～～
...

### ステップ2: Bのセリフをすべて削除し、Aのセリフのみを抜き出す

Aのセリフは改行で区切り、会話の間を表現する。
Bのセリフがあった場所は空行にしない（詰める）。

## 注意事項

- Aのセリフだけで読んでも、Bがどんな発言をしたか推測できるようにする
- Bの発言は「そこに反応する？」という意外性を持たせる
- Aの説明は正確で知的だが、Bには全く伝わらない
- 会話全体の長さは、Aのセリフが40〜60発言程度
- 最後のオチは、Aが諦めたような、乾いたトーンで終わる

---

それでは、上記の条件に従って「片側だけ漫才」の台本を作成してください。テーマはあなたがランダムに選んでください。

#プロンプト2
提案した内容をもとに振り返ってリファインする。
以下の要件が守られているか確認し、AとBのやり取りを修正して再生成して。

Aのセリフだけで読んでも、Bがどんな発言をしたか推測できるようにする
Bの発言は「そこに反応する？」という意外性を持たせる